# `run_replay_cli.py`

`scripts/run_replay_cli.py` provides a lightweight terminal interface for
reviewing recorded games without launching the Qt viewers.  It reads the JSON
logs generated by `utils.load_runs.load_runs`, prints the position after every
move with `main.annotated_board`, and shows which analysis module produced each
move.  The sidebar additionally lists the ThreatMap summary, attack density, and
king coefficient metrics for the current position so the ASCII board mirrors the
viewer experience.

## Usage

```bash
python scripts/run_replay_cli.py --runs runs/ --game-id 20240610_101500
```

Key options:

- `--runs` – directory that contains run JSON files (defaults to `runs/`).
- `--game-id` – identifier of the game (filename without the `.json` extension).
- `--index` – zero-based index when several runs share the same directory.
- `--all` – print the entire sequence in one go instead of prompting.
- `--unicode` – render the board with Unicode figurines.
- `--limit` – cap the number of moves to display.

If multiple run files exist and neither `--game-id` nor `--index` is supplied,
the script lists the available choices and exits.  In interactive mode (the
default), press <kbd>Enter</kbd> to advance, <kbd>a</kbd> to show the remainder
without pauses, or <kbd>q</kbd> to stop replaying.

## Example

```
$ python scripts/run_replay_cli.py --runs demo_runs --game-id mini_match --limit 2 --unicode
Replaying mini_match – 4 moves, result 1-0.
♜♞♝♛♚♝♞♜  │  Game: mini_match
♟♟♟♟♟♟♟♟  │  Result: 1-0
········  │  Initial position
········  │  To move: White
♙♙♙♙♙♙♙♙  │  FEN: rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1
♖♘♗♕♔♗♘♖  │  ThreatMap: thin=…
             │  Attacks: cells W=…, B=… | pieces under attack W=…, B=…
             │  Attack leaders: W=… | B=…
             │  King coeff: W=… | B=…
--------------------------------------------------------------------------------
♜♞♝♛♚♝♞♜  │  Game: mini_match
♟♟♟♟♟♟♟♟  │  Result: 1-0
········  │  Move 1 (White): e4
········  │  White module #1: DynamicBot.attack
♙♙♙♙♙♙♙♙  │  To move: Black
♖♘♗♕♔♗♘♖  │  FEN: rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq - 0 1
             │  ThreatMap: thin=…
             │  Attacks: cells W=…, B=… | pieces under attack W=…, B=…
             │  Attack leaders: W=… | B=…
             │  King coeff: W=… | B=…
--------------------------------------------------------------------------------
...
```

The snippet above demonstrates the Unicode layout, the move annotations, the
module tags for both colours, and the additional metrics column.  Exact numbers
depend on the current position.
