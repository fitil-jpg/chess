<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal Chess Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.13.4/chess.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .board { display: grid; grid-template-columns: repeat(8, 50px); grid-template-rows: repeat(8, 50px); }
        .square { width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; border: 1px solid #ccc; }
        .white { background: #f0d9b5; }
        .black { background: #b58863; }
        .piece { font-size: 30px; }
        button { margin: 10px; padding: 10px 20px; }
    </style>
</head>
<body>
    <h1>Minimal Chess Test</h1>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const ChessTest = () => {
            const [game, setGame] = useState(null);
            const [board, setBoard] = useState([]);
            const [status, setStatus] = useState('Loading...');

            useEffect(() => {
                console.log('Chess available:', typeof Chess);
                if (typeof Chess !== 'undefined') {
                    try {
                        const newGame = new Chess();
                        setGame(newGame);
                        setStatus('Chess loaded successfully!');
                        updateBoard(newGame);
                    } catch (error) {
                        setStatus('Error creating Chess: ' + error.message);
                    }
                } else {
                    setStatus('Chess library not loaded');
                }
            }, []);

            const updateBoard = (gameInstance) => {
                const board = [];
                for (let row = 0; row < 8; row++) {
                    const boardRow = [];
                    for (let col = 0; col < 8; col++) {
                        const square = String.fromCharCode(97 + col) + (8 - row);
                        const piece = gameInstance.get(square);
                        boardRow.push({
                            square,
                            piece,
                            color: (row + col) % 2 === 0 ? 'white' : 'black'
                        });
                    }
                    board.push(boardRow);
                }
                setBoard(board);
            };

            const getPieceSymbol = (piece) => {
                if (!piece) return '';
                const symbols = {
                    'wK': '♔', 'wQ': '♕', 'wR': '♖', 'wB': '♗', 'wN': '♘', 'wP': '♙',
                    'bK': '♚', 'bQ': '♛', 'bR': '♜', 'bB': '♝', 'bN': '♞', 'bP': '♟'
                };
                return symbols[piece.color + piece.type.toUpperCase()] || '';
            };

            const makeRandomMove = () => {
                if (!game) return;
                const moves = game.moves();
                if (moves.length > 0) {
                    const randomMove = moves[Math.floor(Math.random() * moves.length)];
                    game.move(randomMove);
                    updateBoard(game);
                    setStatus(`Move: ${randomMove}`);
                }
            };

            const resetGame = () => {
                if (typeof Chess !== 'undefined') {
                    const newGame = new Chess();
                    setGame(newGame);
                    updateBoard(newGame);
                    setStatus('Game reset');
                }
            };

            return React.createElement('div', null,
                React.createElement('p', null, status),
                React.createElement('div', { className: 'board' },
                    board.map((row, rowIndex) =>
                        row.map((cell, colIndex) =>
                            React.createElement('div', {
                                key: `${rowIndex}-${colIndex}`,
                                className: `square ${cell.color}`
                            },
                                cell.piece && React.createElement('span', { className: 'piece' },
                                    getPieceSymbol(cell.piece)
                                )
                            )
                        )
                    )
                ),
                React.createElement('div', null,
                    React.createElement('button', { onClick: makeRandomMove }, 'Random Move'),
                    React.createElement('button', { onClick: resetGame }, 'Reset Game')
                )
            );
        };

        ReactDOM.render(React.createElement(ChessTest), document.getElementById('root'));
    </script>
</body>
</html>